{"version":3,"file":"canvas.js","sources":["../../assets/script/animate.ts","../../assets/script/canvas.ts"],"sourcesContent":["export const requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window[\"mozRequestAnimationFrame\"] ||\n  window.webkitRequestAnimationFrame ||\n  window[\"msRequestAnimationFrame\"] ||\n  (cb => window.setTimeout(cb, 1000 / 60));\n\n// no easing, no acceleration\nexport const linear = t => t;\n// accelerating from zero velocity\nexport const easeInQuad = t => t * t;\n// decelerating to zero velocity\nexport const easeOutQuad = t => t * (2 - t);\n// acceleration until halfway, then deceleration\nexport const easeInOutQuad = t => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\n// accelerating from zero velocity\nexport const easeInCubic = t => t * t * t;\n// decelerating to zero velocity\nexport const easeOutCubic = t => --t * t * t + 1;\n// acceleration until halfway, then deceleration\nexport const easeInOutCubic = t =>\n  t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n// accelerating from zero velocity\nexport const easeInQuart = t => t * t * t * t;\n// decelerating to zero velocity\nexport const easeOutQuart = t => 1 - --t * t * t * t;\n// acceleration until halfway, then deceleration\nexport const easeInOutQuart = t =>\n  t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n// accelerating from zero velocity\nexport const easeInQuint = t => t * t * t * t * t;\n// decelerating to zero velocity\nexport const easeOutQuint = t => 1 + --t * t * t * t * t;\n// acceleration until halfway, then deceleration\nexport const easeInOutQuint = t =>\n  t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n\nclass Animate {\n  private id = 0;\n  private active = {};\n  constructor() {}\n\n  private uniqKey() {\n    return ++this.id;\n  }\n\n  exec(\n    transform: Function,\n    duration: number,\n    easingFn: Function = linear,\n    cb?: Function\n  ) {\n    const key = this.uniqKey();\n    this.active[key] = true;\n    const start = performance.now();\n    const render = (now = performance.now()) => {\n      const delta = now - start;\n      if (!this.active[key] || delta >= duration) {\n        transform(1);\n        delete this.active[key];\n        cb && cb();\n        return;\n      }\n      transform(easingFn(delta / duration));\n      requestAnimationFrame(render);\n    };\n    requestAnimationFrame(render);\n  }\n\n  cancel(key: number) {\n    if (this.active[key] === true) {\n      this.active[key] = false;\n    }\n  }\n}\n\nexport default new Animate();\n","import { requestAnimationFrame } from \"./animate\";\n\nconst flakes = [];\nconst canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\nconst ctx = canvas.getContext(\"2d\");\nlet flakeCount = 400;\nlet mX = -100;\nlet mY = -100;\n\nfunction resize() {\n  canvas.width = canvas.scrollWidth;\n  canvas.height = canvas.scrollHeight;\n  flakeCount = Math.min(400, canvas.width / 5);\n}\n\nfunction snow() {\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  if (flakeCount > flakes.length) {\n    for (let i = flakes.length; i < flakeCount; i++) flakes.push(create());\n  }\n  for (let i = 0; i < flakes.length; i++) {\n    const flake = flakes[i],\n      x = mX,\n      y = mY,\n      minDist = 150,\n      x2 = flake.x,\n      y2 = flake.y;\n\n    const dist = Math.sqrt((x2 - x) * (x2 - x) + (y2 - y) * (y2 - y)),\n      dx = x2 - x,\n      dy = y2 - y;\n\n    if (dist < minDist) {\n      const force = minDist / (dist * dist),\n        xcomp = (x - x2) / dist,\n        ycomp = (y - y2) / dist,\n        deltaV = force / 2;\n\n      flake.velX -= deltaV * xcomp;\n      flake.velY -= deltaV * ycomp;\n    } else {\n      flake.velX *= 0.98;\n      if (flake.velY <= flake.speed) {\n        flake.velY = flake.speed;\n      }\n      flake.velX += Math.cos((flake.step += 0.05)) * flake.stepSize;\n    }\n\n    ctx.fillStyle = \"rgba(255,255,255,\" + flake.opacity + \")\";\n    flake.y += flake.velY;\n    flake.x += flake.velX;\n\n    if (flake.y >= canvas.height || flake.y <= 0) {\n      if (reset(flake) === false) {\n        flakes.splice(i--, 1);\n        continue;\n      }\n    }\n\n    if (flake.x >= canvas.width || flake.x <= 0) {\n      if (reset(flake) === false) {\n        flakes.splice(i--, 1);\n        continue;\n      }\n    }\n\n    ctx.beginPath();\n    ctx.arc(flake.x, flake.y, flake.size, 0, Math.PI * 2);\n    ctx.fill();\n  }\n\n  requestAnimationFrame(snow);\n}\n\nfunction reset(flake) {\n  if (flakeCount < flakes.length) {\n    return false;\n  }\n  flake.x = Math.floor(Math.random() * canvas.width);\n  flake.y = 0;\n  flake.size = Math.random() * 3 + 2;\n  flake.speed = Math.random() * 1 + 0.5;\n  flake.velY = flake.speed;\n  flake.velX = 0;\n  flake.opacity = Math.random() * 0.5 + 0.3;\n  return true;\n}\n\nfunction create() {\n  const x = Math.floor(Math.random() * canvas.width),\n    y = Math.floor(Math.random() * canvas.height),\n    size = Math.random() * 3 + 2,\n    speed = Math.random() * 1 + 0.5,\n    opacity = Math.random() * 0.5 + 0.3;\n\n  return {\n    speed: speed,\n    velY: speed,\n    velX: 0,\n    x: x,\n    y: y,\n    size: size,\n    stepSize: Math.random() / 30,\n    step: 0,\n    opacity: opacity\n  };\n}\n\nfunction init() {\n  flakeCount = canvas.width / 5;\n  for (let i = 0; i < flakeCount; i++) {\n    flakes.push(create());\n  }\n  snow();\n}\n\nconst splash = document.querySelector(\".splash\");\nif (splash) {\n  splash.addEventListener(\"mousemove\", (e: MouseEvent) => {\n    (mX = e.clientX), (mY = e.clientY);\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  window.addEventListener(\"resize\", resize);\n  resize();\n  init();\n});\n"],"names":[],"mappings":"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"}